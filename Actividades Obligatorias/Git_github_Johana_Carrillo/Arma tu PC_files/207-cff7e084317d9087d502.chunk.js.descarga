(("undefined"!==typeof self?self:this).webpackJsonp=("undefined"!==typeof self?self:this).webpackJsonp||[]).push([[207],{1271:function(t,e,i){t.exports=i.p+"media/images/drag_and_drop_hexagon-2df7708da1f8b54d36b8b03ccb5b2a53.svg"},1272:function(t,e,i){t.exports=i.p+"media/images/drag_and_drop_hexagon_outline-73f9e6d4986d9c6d6c7905c6d7c3b2dd.svg"},1393:function(t,e,i){"use strict";i.r(e);var o,n,a,r=i(2),s=i(8),d=i(717),p=i(3),c=i(1271),l=i.n(c),g=i(1272),h=i.n(g),f=function(t,e,i,o){var n,a=arguments.length,r=a<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(r=(a<3?n(r):a>3?n(e,i,r):n(e,i))||r);return a>3&&r&&Object.defineProperty(e,i,r),r},y=function(t,e){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(t,e)};const u=Object(s.d)("composerModal"),D=Object(s.d)("composerModalAlert"),v=Object(s.d)("contentPicker"),A=Object(s.d)("dragAndDropEvents"),m=Object(s.d)("draft"),b=Object(s.d)("post"),_=Object(s.d)("map");let k=class extends(Object(r.c)()){constructor(){super(...arguments),this.dragAndDropHexagon=l.a,this.dragAndDropHexagonOutline=h.a}get backgroundClasses(){return this.isAnyDraftActive?["bg-transparent"]:["bg-grape-500","dark:bg-drag-overlay-dark","bg-opacity-50","dark:bg-opacity-35"]}get xMessageHexagon(){return!this.isAnyDraftActive}get isAnyComposerModalDocked(){return this.isAnyDraftActive&&this.composerModalShouldDock}initFileDragEvent(){this.setDraggedDataType({newType:d.a.File});let t="";t=this.isAnyDraftActive?this.isAnyComposerModalDocked?this.__("Drop the file here to add it to this post"):this.__("Drop the file anywhere to add it to this post"):this.__("Drop files anywhere to create a new post"),this.setDropActionMessage({message:t})}initLinkDragEvent(){this.setDraggedDataType({newType:d.a.Link});let t="";t=this.isAnyDraftActive?this.isAnyComposerModalDocked?this.__("Drop the link here to add it to this post"):this.__("Drop the link anywhere to add to this post"):this.__("Drop links anywhere to create a new post"),this.setDropActionMessage({message:t})}initTextDragEvent(){this.setDraggedDataType({newType:d.a.Text});let t="";t=this.isAnyDraftActive?this.isAnyComposerModalDocked?this.__("Drop the text here to add it to this post"):this.__("Drop the text anywhere to add it to this post"):this.__("Drop text anywhere to create a new post"),this.setDropActionMessage({message:t})}setupDragEvent(t){if(!t.dataTransfer)return void this.stopHandlingDragEvent();const e=t.dataTransfer.types;this.resetAlert(),e.includes("Files")?this.initFileDragEvent():e.includes("text/uri-list")?this.initLinkDragEvent():e.includes("text/plain")?this.initTextDragEvent():this.stopHandlingDragEvent()}handleFileDrop({files:t,left:e,top:i,shouldAddToActiveDraft:o}){if(t&&0!==t.length)if(o){if(t.length>1)return void this.openAlert({title:this.__("Multiple files added"),body:this.__("While writing a post only one file can be added at a time"),primaryActionText:this.__("Okay"),primaryActions:[]});const e=t[0];if(this.activeDraft.attachment||this.activeDraftUploadingFile){const t=this.activeDraft.attachment?[{type:"draft/removeDraftAttachment",payload:{postCid:this.activeDraft.cid}},{type:"draft/uploadFileActiveDraft",payload:{file:e}}]:[{type:"draft/replaceActiveDraftUploadingFile",payload:{file:e}}];return void this.openAlert({title:this.__("An attachment already exists"),body:this.__("Are you sure you want to replace your current attachment?"),primaryActionText:this.__("Replace"),secondaryActionText:this.__("Cancel"),secondaryActions:[],primaryActions:t})}this.uploadFileActiveDraft({file:e})}else if(1===t.length){const o={file:t[0],left:e,top:i},n=!this.isAnyDraftActive;this.startNewDraft({attributes:o,shouldStartEditing:n}),n&&this.dockComposerModal()}else for(let n=0;n<t.length;++n){const o={attributes:{file:t[n],left:e+8*n,top:i+8*n}};this.createPost(o)}}handleLinkDrop({link:t,left:e,top:i,shouldAddToActiveDraft:o}){if(t)if(o){if(this.activeDraft.attachment||this.activeDraftUploadingFile)return void this.openAlert({title:this.__("An attachment already exists"),body:this.__("Are you sure you want to replace your current attachment?"),primaryActionText:this.__("Replace"),secondaryActionText:this.__("Cancel"),secondaryActions:[],primaryActions:[{type:"draft/replaceActiveDraftAttachmentWithLink",payload:{link:t}}]});this.updateActiveDraft({attachment:t,wish_content:{attachment_props:{url:t},is_processed:!1}})}else{const o={attachment:t,left:e,top:i},n=!this.isAnyDraftActive;this.startNewDraft({attributes:o,shouldStartEditing:n}),n&&this.dockComposerModal()}}handleTextDrop({text:t,left:e,top:i,shouldAddToActiveDraft:o}){if(!t)return;const n=t.replace(/\n/g,"<br/>");if(o)this.updateActiveDraft({body:(this.activeDraft.body||"")+"<br/>"+n});else{const t={body:n,left:e,top:i},o=!this.isAnyDraftActive;this.startNewDraft({attributes:t,shouldStartEditing:o}),o&&this.dockComposerModal()}}onDrop(t){this.isContentPickerOpened&&this.hideContentSourceMenu(),this.stopHandlingDragEvent();const e=t.dataTransfer;if(!e)return;const i=document.getElementById("wish-list"),o=Math.max(t.pageX-(i?i.getBoundingClientRect().left:0),0),n=Math.max(t.pageY-(i?i.getBoundingClientRect().top:0),0),a=this.isAnyComposerModalDocked&&this.postModalDropZone&&(t.clientX<this.postModalDropZone.left||t.clientX>this.postModalDropZone.right||t.clientY<this.postModalDropZone.top||t.clientY>this.postModalDropZone.bottom),r=this.isAnyDraftActive&&!a;this.draggedDataType===d.a.File?this.handleFileDrop({files:e.files,left:o,top:n,shouldAddToActiveDraft:r}):this.draggedDataType===d.a.Link?this.handleLinkDrop({link:e.getData("text/uri-list"),left:o,top:n,shouldAddToActiveDraft:r}):this.draggedDataType===d.a.Text&&this.handleTextDrop({text:e.getData("text/plain"),left:o,top:n,shouldAddToActiveDraft:r})}checkAndStartHandlingDragEvent(t){var e;const i=!!(null===(e=null===t||void 0===t?void 0:t.dataTransfer)||void 0===e?void 0:e.types)&&t.dataTransfer.types.includes("text/html")&&!t.dataTransfer.types.includes("text/plain");!t.dataTransfer||this.isMapHandlingDragEvent||i||this.startHandlingDragEvent()}onOverlayShown(t){t&&setTimeout(()=>{this.dropActionMessage||this.stopHandlingDragEvent()},500)}mounted(){p.a.addEventListener("dragenter",this.checkAndStartHandlingDragEvent)}beforeDestroy(){p.a.removeEventListener("dragenter",this.checkAndStartHandlingDragEvent)}};f([u.Getter("isDocked"),y("design:type",Boolean)],k.prototype,"composerModalShouldDock",void 0),f([v.Getter("xContentSourceMenu"),y("design:type",Boolean)],k.prototype,"isContentPickerOpened",void 0),f([A.Getter,y("design:type",Boolean)],k.prototype,"isHandlingDragEvent",void 0),f([A.Getter,y("design:type",String)],k.prototype,"dropActionMessage",void 0),f([A.Getter,y("design:type","function"===typeof(o="undefined"!==typeof d.a&&d.a)?o:Object)],k.prototype,"draggedDataType",void 0),f([A.Getter,y("design:type","function"===typeof(n="undefined"!==typeof PostModalDropZone&&PostModalDropZone)?n:Object)],k.prototype,"postModalDropZone",void 0),f([m.Getter,y("design:type","function"===typeof(a="undefined"!==typeof DraftPost&&DraftPost)?a:Object)],k.prototype,"activeDraft",void 0),f([m.Getter,y("design:type",Object)],k.prototype,"activeDraftUploadingFile",void 0),f([m.Getter,y("design:type",Boolean)],k.prototype,"isAnyDraftActive",void 0),f([_.Getter("isDraggingLocationPickerPin"),y("design:type",Boolean)],k.prototype,"isMapHandlingDragEvent",void 0),f([u.Action("dock"),y("design:type",Function)],k.prototype,"dockComposerModal",void 0),f([D.Action,y("design:type",Function)],k.prototype,"openAlert",void 0),f([D.Action,y("design:type",Function)],k.prototype,"resetAlert",void 0),f([v.Action,y("design:type",Function)],k.prototype,"hideContentSourceMenu",void 0),f([m.Action,y("design:type",Function)],k.prototype,"uploadFileActiveDraft",void 0),f([m.Action,y("design:type",Function)],k.prototype,"updateActiveDraft",void 0),f([m.Action,y("design:type",Function)],k.prototype,"startNewDraft",void 0),f([A.Action,y("design:type",Function)],k.prototype,"startHandlingDragEvent",void 0),f([A.Action,y("design:type",Function)],k.prototype,"stopHandlingDragEvent",void 0),f([A.Action,y("design:type",Function)],k.prototype,"setDraggedDataType",void 0),f([A.Action,y("design:type",Function)],k.prototype,"setDropActionMessage",void 0),f([b.Action,y("design:type",Function)],k.prototype,"createPost",void 0),f([Object(r.g)("isHandlingDragEvent"),y("design:type",Function),y("design:paramtypes",[Boolean]),y("design:returntype",void 0)],k.prototype,"onOverlayShown",null),k=f([Object(r.a)({})],k);var x=k,M=i(5),T=Object(M.a)(x,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{directives:[{name:"show",rawName:"v-show",value:t.isHandlingDragEvent,expression:"isHandlingDragEvent"}],ref:"draggingOverlay",class:["fixed","inset-0","z-dragging-overlay"].concat(t.backgroundClasses),on:{dragenter:function(e){return e.preventDefault(),t.setupDragEvent(e)},dragover:function(t){t.preventDefault()},dragleave:function(e){return e.preventDefault(),t.stopHandlingDragEvent(e)},dragend:function(e){return e.preventDefault(),t.stopHandlingDragEvent(e)},drop:function(e){return e.preventDefault(),t.onDrop(e)}}},[t.isAnyDraftActive?t._e():i("div",{class:["w-[14.375rem]","h-[15.75rem]","absolute","pointer-events-none","inset-0","m-auto","bg-light-ui-100 dark:bg-dark-ui-100"],style:{maskImage:"url("+t.dragAndDropHexagonOutline+")",maskSize:"100% 100%"}},[i("div",{class:["w-[13.875rem]","h-[15.25rem]","absolute","inset-0","m-auto","flex","items-center","justify-center","bg-grape-500 dark:bg-canary-500"],style:{maskImage:"url("+t.dragAndDropHexagon+")",maskSize:"100% 100%"}},[i("div",{class:["w-[12rem]","text-input-body","font-sans","text-center","text-light-text-100 dark:text-dark-text-100","break-words"]},[t._v("\n        "+t._s(t.dropActionMessage)+"\n      ")])])])])}),[],!1,null,null,null);e.default=T.exports}}]);
//# sourceMappingURL=207-cff7e084317d9087d502.chunk.js.map